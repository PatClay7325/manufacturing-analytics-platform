Deploying Manufacturing Analytics Platform...
[0;34mStopping existing containers...[0m
[0;34mBuilding Docker images...[0m
Compose can now delegate builds to bake for better performance.
 To do so, set COMPOSE_BAKE=true.
#0 building with "default" instance using docker driver

#1 [manufacturing-app internal] load build definition from Dockerfile
#1 transferring dockerfile: 30B 0.1s
#1 transferring dockerfile: 1.59kB 0.6s done
#1 DONE 0.6s

#2 [manufacturing-app internal] load metadata for docker.io/library/node:18-alpine
#2 DONE 0.1s

#3 [manufacturing-app internal] load .dockerignore
#3 transferring context: 33B
#3 transferring context: 2.02kB 0.6s done
#3 DONE 0.6s

#4 [manufacturing-app internal] load build context
#4 DONE 0.0s

#5 [manufacturing-app deps 1/6] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 ...

#6 [manufacturing-app auth] library/node:pull token for registry-1.docker.io
#6 DONE 0.0s

#5 [manufacturing-app deps 1/6] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e 0.8s done
#5 DONE 0.8s

#7 [manufacturing-app builder 2/6] WORKDIR /app
#7 CACHED

#4 [manufacturing-app internal] load build context
#4 ...

#8 [manufacturing-app runner  3/10] RUN apk add --no-cache dumb-init
#8 0.363 fetch https://dl-cdn.alpinelinux.org/alpine/v3.21/main/x86_64/APKINDEX.tar.gz
#8 0.836 fetch https://dl-cdn.alpinelinux.org/alpine/v3.21/community/x86_64/APKINDEX.tar.gz
#8 1.447 (1/1) Installing dumb-init (1.2.5-r3)
#8 1.479 Executing busybox-1.37.0-r12.trigger
#8 1.491 OK: 10 MiB in 18 packages
#8 DONE 1.6s

#4 [manufacturing-app internal] load build context
#4 ...

#9 [manufacturing-app runner  4/10] RUN addgroup --system --gid 1001 nodejs
#9 DONE 0.4s

#4 [manufacturing-app internal] load build context
#4 ...

#10 [manufacturing-app runner  5/10] RUN adduser --system --uid 1001 nextjs
#10 DONE 0.5s

#4 [manufacturing-app internal] load build context
#4 transferring context: 26.91kB 4.3s
#4 transferring context: 67.11kB 9.3s
#4 transferring context: 111.46kB 13.6s done
#4 DONE 13.6s

#11 [manufacturing-app deps 2/6] RUN apk add --no-cache libc6-compat python3 make g++
#11 CACHED

#12 [manufacturing-app deps 3/6] WORKDIR /app
#12 CACHED

#13 [manufacturing-app deps 4/6] COPY package.json package-lock.json ./
#13 CACHED

#14 [manufacturing-app deps 5/6] COPY prisma ./prisma/
#14 CACHED

#15 [manufacturing-app deps 6/6] RUN npm ci
#15 1.970 npm warn EBADENGINE Unsupported engine {
#15 1.970 npm warn EBADENGINE   package: 'got@14.4.7',
#15 1.970 npm warn EBADENGINE   required: { node: '>=20' },
#15 1.970 npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
#15 1.970 npm warn EBADENGINE }
#15 9.442 npm warn deprecated querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.
#15 12.94 npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
#15 22.72 npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
#15 22.72 npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
#15 22.97 npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
#15 23.19 npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
#15 23.76 npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
#15 23.77 npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
#15 76.03 
#15 76.03 added 1480 packages, and audited 1481 packages in 1m
#15 76.03 
#15 76.03 314 packages are looking for funding
#15 76.03   run `npm fund` for details
#15 76.09 
#15 76.09 11 vulnerabilities (6 moderate, 2 high, 3 critical)
#15 76.09 
#15 76.09 To address issues that do not require attention, run:
#15 76.09   npm audit fix
#15 76.09 
#15 76.09 To address all issues possible (including breaking changes), run:
#15 76.09   npm audit fix --force
#15 76.09 
#15 76.09 Some issues need review, and may require choosing
#15 76.09 a different dependency.
#15 76.09 
#15 76.09 Run `npm audit` for details.
#15 76.10 npm notice
#15 76.10 npm notice New major version of npm available! 10.8.2 -> 11.4.2
#15 76.10 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.4.2
#15 76.10 npm notice To update run: npm install -g npm@11.4.2
#15 76.10 npm notice
#15 DONE 76.8s

#16 [manufacturing-app builder 3/6] COPY --from=deps /app/node_modules ./node_modules
#16 DONE 20.3s

#17 [manufacturing-app builder 4/6] COPY . .
#17 DONE 1.4s

#18 [manufacturing-app builder 5/6] RUN npx prisma generate
#18 1.851 prisma:warn Prisma failed to detect the libssl/openssl version to use, and may not work as expected. Defaulting to "openssl-1.1.x".
#18 1.851 Please manually install OpenSSL and try installing Prisma again.
#18 3.402 Environment variables loaded from .env
#18 3.408 Prisma schema loaded from prisma/schema.prisma
#18 3.470 prisma:warn Prisma failed to detect the libssl/openssl version to use, and may not work as expected. Defaulting to "openssl-1.1.x".
#18 3.470 Please manually install OpenSSL and try installing Prisma again.
#18 5.725 
#18 5.725 âœ” Generated Prisma Client (v5.22.0) to ./node_modules/@prisma/client in 1.31s
#18 5.725 
#18 5.725 Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)
#18 5.725 
#18 5.725 Tip: Easily identify and fix slow SQL queries in your app. Optimize helps you enhance your visibility: https://pris.ly/--optimize
#18 5.725 
#18 5.921 npm notice
#18 5.921 npm notice New major version of npm available! 10.8.2 -> 11.4.2
#18 5.921 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.4.2
#18 5.921 npm notice To update run: npm install -g npm@11.4.2
#18 5.921 npm notice
#18 DONE 6.0s

#19 [manufacturing-app builder 6/6] RUN npm run build
#19 0.536 
#19 0.536 > adaptive-factory-ai-solutions@1.0.0 build
#19 0.536 > node node_modules/next/dist/bin/next build
#19 0.536 
#19 1.436    â–² Next.js 15.1.4
#19 1.437    - Environments: .env.production, .env
#19 1.437    - Experiments (use with caution):
#19 1.437      Â· optimizeCss
#19 1.437      Â· scrollRestoration
#19 1.438 
#19 1.516    Creating an optimized production build ...
#19 82.52  âš  Compiled with warnings
#19 82.52 
#19 82.52 ./src/app/api/history/route.ts
#19 82.52 Attempted import error: 'getFieldAlias' is not exported from '@/lib/schema-introspection' (imported as 'getFieldAlias').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/history/route.ts
#19 82.52 
#19 82.52 ./src/app/api/history/route.ts
#19 82.52 Attempted import error: 'normalizeFieldName' is not exported from '@/lib/schema-introspection' (imported as 'normalizeFieldName').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/history/route.ts
#19 82.52 
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 Attempted import error: 'authOptions' is not exported from '@/lib/auth' (imported as 'authOptions').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 Attempted import error: 'authOptions' is not exported from '@/lib/auth' (imported as 'authOptions').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 Attempted import error: 'authOptions' is not exported from '@/lib/auth' (imported as 'authOptions').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 Attempted import error: 'authOptions' is not exported from '@/lib/auth' (imported as 'authOptions').
#19 82.52 
#19 82.52 Import trace for requested module:
#19 82.52 ./src/app/api/import/manufacturing-data/route.ts
#19 82.52 
#19 82.53    Linting and checking validity of types ...
#19 133.5 
#19 133.5 <--- Last few GCs --->
#19 133.5 
#19 133.5 [38:0x7f962f41e050]    49333 ms: Scavenge (reduce) 2043.8 (2082.6) -> 2043.1 (2082.9) MB, 8.4 / 0.0 ms  (average mu = 0.289, current mu = 0.351) allocation failure; 
#19 133.5 [38:0x7f962f41e050]    50145 ms: Mark-sweep (reduce) 2043.9 (2082.9) -> 2042.5 (2082.9) MB, 809.3 / 0.0 ms  (average mu = 0.245, current mu = 0.199) allocation failure; scavenge might not succeed
#19 133.5 
#19 133.5 
#19 133.5 <--- JS stacktrace --->
#19 133.5 
#19 133.5 FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
#19 152.1 Static worker exited with code: null and signal: SIGABRT
#19 ERROR: process "/bin/sh -c npm run build" did not complete successfully: exit code: 1
------
 > [manufacturing-app builder 6/6] RUN npm run build:
133.5 <--- Last few GCs --->
133.5 
133.5 [38:0x7f962f41e050]    49333 ms: Scavenge (reduce) 2043.8 (2082.6) -> 2043.1 (2082.9) MB, 8.4 / 0.0 ms  (average mu = 0.289, current mu = 0.351) allocation failure; 
133.5 [38:0x7f962f41e050]    50145 ms: Mark-sweep (reduce) 2043.9 (2082.9) -> 2042.5 (2082.9) MB, 809.3 / 0.0 ms  (average mu = 0.245, current mu = 0.199) allocation failure; scavenge might not succeed
133.5 
133.5 
133.5 <--- JS stacktrace --->
133.5 
133.5 FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
152.1 Static worker exited with code: null and signal: SIGABRT
------
failed to solve: process "/bin/sh -c npm run build" did not complete successfully: exit code: 1
